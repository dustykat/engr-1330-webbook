<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        
        
        
        <link rel="shortcut icon" href="../../../img/favicon.ico">
        <title>Linear Equation Systems - Engr 1330 - Web Book</title>
        <link href="../../../css/bootstrap-custom.min.css" rel="stylesheet">
        <link href="../../../css/font-awesome.min.css" rel="stylesheet">
        <link href="../../../css/base.css" rel="stylesheet">
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/github.min.css">

        <script src="../../../js/jquery-1.10.2.min.js" defer></script>
        <script src="../../../js/bootstrap-3.0.3.min.js" defer></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/languages/python.min.js"></script>
        <script>hljs.initHighlightingOnLoad();</script> 
    </head>

    <body>

        <div class="navbar navbar-default navbar-fixed-top" role="navigation">
            <div class="container">

                <!-- Collapsed navigation -->
                <div class="navbar-header">
                    <!-- Expander button -->
                    <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
                        <span class="sr-only">Toggle navigation</span>
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                    </button>
                    <a class="navbar-brand" href="../../..">Engr 1330 - Web Book</a>
                </div>

                <!-- Expanded navigation -->
                <div class="navbar-collapse collapse">
                        <!-- Main navigation -->
                        <ul class="nav navbar-nav">
                            <li >
                                <a href="../../..">Home</a>
                            </li>
                            <li class="dropdown">
                                <a href="#" class="dropdown-toggle" data-toggle="dropdown">Introduction <b class="caret"></b></a>
                                <ul class="dropdown-menu">
                                    
<li >
    <a href="../../Lesson00/lesson0/">Computational Thinking and Data Science</a>
</li>
                                    
<li >
    <a href="../../Lesson01/lesson1/">Problem Solving with Computational Thinking</a>
</li>
                                </ul>
                            </li>
                            <li class="dropdown">
                                <a href="#" class="dropdown-toggle" data-toggle="dropdown">Scripting Fundamentals <b class="caret"></b></a>
                                <ul class="dropdown-menu">
                                    
<li >
    <a href="../../Lesson02/lesson2/">Simple Computation</a>
</li>
                                    
<li >
    <a href="../../Lesson03/lesson3/">Data Structures and the MATH package</a>
</li>
                                    
<li >
    <a href="../../Lesson04/lesson4/">Program Control Structures</a>
</li>
                                    
<li >
    <a href="../../../lesson0/lesson0/">External Functions and Modules</a>
</li>
                                    
<li >
    <a href="../../../lesson0/lesson0/">Engineering and Scientific Data Files</a>
</li>
                                    
<li >
    <a href="../../Lesson07/lesson6/">Computational Linear Algebra using NUMPY</a>
</li>
                                    
<li >
    <a href="../../Lesson08/lesson7/">Database Query and Manipulation using PANDAS</a>
</li>
                                    
<li >
    <a href="../../Lesson09/lesson8/">Visual Display of Data using MATPLOTLIB</a>
</li>
                                </ul>
                            </li>
                            <li class="dropdown active">
                                <a href="#" class="dropdown-toggle" data-toggle="dropdown">Engineering Computation <b class="caret"></b></a>
                                <ul class="dropdown-menu">
                                    
<li >
    <a href="../../Lesson10/lesson10/">Implicit Equations</a>
</li>
                                    
<li >
    <a href="../../Lesson11/lesson11/">Interpolation and Integration</a>
</li>
                                    
<li class="active">
    <a href="./">Linear Equation Systems</a>
</li>
                                    
<li >
    <a href="../../Lesson13/lesson13/">Non-Linear Equation Systems</a>
</li>
                                </ul>
                            </li>
                            <li class="dropdown">
                                <a href="#" class="dropdown-toggle" data-toggle="dropdown">Models and Decisions <b class="caret"></b></a>
                                <ul class="dropdown-menu">
                                    
<li >
    <a href="../../../lesson0/lesson0/">Statistical Data Modeling</a>
</li>
                                    
<li >
    <a href="../../../lesson0/lesson0/">Randomness and Probability</a>
</li>
                                    
<li >
    <a href="../../Lesson15/lesson15/">Descriptive Statistics</a>
</li>
                                    
<li >
    <a href="../../../lesson0/lesson0/">Distribution Models</a>
</li>
                                    
<li >
    <a href="../../Lesson17/lesson17/">Probability Estimation Modeling</a>
</li>
                                    
<li >
    <a href="../../../lesson0/lesson0/">Hypothesis Testing</a>
</li>
                                    
<li >
    <a href="../../../lesson0/lesson0/">Experimental Design (A/B Testing)</a>
</li>
                                    
<li >
    <a href="../../../lesson0/lesson0/">Interval Estimates</a>
</li>
                                </ul>
                            </li>
                            <li class="dropdown">
                                <a href="#" class="dropdown-toggle" data-toggle="dropdown">Prediction <b class="caret"></b></a>
                                <ul class="dropdown-menu">
                                    
<li >
    <a href="../../../lesson0/lesson0/">Fitting Models to Observations</a>
</li>
                                    
<li >
    <a href="../../../lesson0/lesson0/">Least Squares (Regression) Model Fitting</a>
</li>
                                    
<li >
    <a href="../../../lesson0/lesson0/">Model Quality</a>
</li>
                                    
<li >
    <a href="../../../lesson0/lesson0/">Estimating Probability/Quantile Regression</a>
</li>
                                </ul>
                            </li>
                            <li class="dropdown">
                                <a href="#" class="dropdown-toggle" data-toggle="dropdown">Classification <b class="caret"></b></a>
                                <ul class="dropdown-menu">
                                    
<li >
    <a href="../../../lesson0/lesson0/">Introduction</a>
</li>
                                    
<li >
    <a href="../../../lesson0/lesson0/">Types</a>
</li>
                                    
<li >
    <a href="../../../lesson0/lesson0/">K Nearest Neighbor</a>
</li>
                                    
<li >
    <a href="../../../lesson0/lesson0/">Engine Update</a>
</li>
                                </ul>
                            </li>
                        </ul>

                    <ul class="nav navbar-nav navbar-right">
                        <li>
                            <a href="#" data-toggle="modal" data-target="#mkdocs_search_modal">
                                <i class="fa fa-search"></i> Search
                            </a>
                        </li>
                            <li >
                                <a rel="next" href="../../Lesson11/lesson11/">
                                    <i class="fa fa-arrow-left"></i> Previous
                                </a>
                            </li>
                            <li >
                                <a rel="prev" href="../../Lesson13/lesson13/">
                                    Next <i class="fa fa-arrow-right"></i>
                                </a>
                            </li>
                    </ul>
                </div>
            </div>
        </div>

        <div class="container">
                <div class="col-md-3"><div class="bs-sidebar hidden-print affix well" role="complementary">
    <ul class="nav bs-sidenav">
        <li class="main active"><a href="#engr-1330-computational-thinking-with-data-science">ENGR 1330 Computational Thinking with Data Science</a></li>
            <li><a href="#lesson-12-linear-systems-of-equations">Lesson 12 Linear Systems of Equations</a></li>
            <li><a href="#objectives">Objectives</a></li>
            <li><a href="#matrix-arithmetic">Matrix Arithmetic</a></li>
            <li><a href="#supply-code-with-pivoting">Supply Code with Pivoting</a></li>
            <li><a href="#supply-numpy-code">Supply numpy code</a></li>
            <li><a href="#do-a-couple-examples">Do a couple examples</a></li>
            <li><a href="#practical-application-of-linear-solvers">Practical Application of Linear Solvers</a></li>
            <li><a href="#references">References</a></li>
    </ul>
</div></div>
                <div class="col-md-9" role="main">

<p>Copyright Â© 2021  Author, <em>all rights reserved</em></p>
<h1 id="engr-1330-computational-thinking-with-data-science">ENGR 1330 Computational Thinking with Data Science</h1>
<p>Last GitHub Commit Date: </p>
<h2 id="lesson-12-linear-systems-of-equations">Lesson 12 Linear Systems of Equations</h2>
<p>This lesson will </p>
<hr />
<h2 id="objectives">Objectives</h2>
<ul>
<li>Construct multivariate linear equation systems</li>
<li>Solve using a Gaussian Reduction method</li>
<li>Demonstrate practical application with a </li>
</ul>
<h2 id="matrix-arithmetic">Matrix Arithmetic</h2>
<p>Use Dannemiller's matrix notes or Cleveland's old notes.  Typeset to use typical Matrix-Vector forms.</p>
<h3 id="scalar-multiply-a-vector">Scalar Multiply a Vector</h3>
<h3 id="vector-inner-product-dot-product">Vector Inner Product (Dot Product)</h3>
<h3 id="matrix-vector-product">Matrix Vector Product</h3>
<h3 id="matrix-matrix-product">Matrix Matrix Product</h3>
<h3 id="matrix-inversion">Matrix Inversion</h3>
<p>In many practical computational and theoretical operations we employ the concept of the inverse of a matrix.
The inverse is somewhat analogous to "dividing" by the matrix.<br />
Consider our linear system:</p>
<p>
<script type="math/tex">
<script type="math/tex; mode=display">\begin{gather}
\mathbf{A} \cdot \mathbf{x} = \mathbf{b}
\end{gather}</script>
</script>
</p>
<p>If we wished to solve for <script type="math/tex">\mathbf{x}</script> we would "divide" both sides of the equation by <script type="math/tex">\mathbf{A}</script>.   </p>
<p>Instead of division (which is undefined for matrices) we instead multiply by the inverse of the matrix. The inverse of a matrix <script type="math/tex">\mathbf{A}</script> is denoted by <script type="math/tex">\mathbf{A}^{-1}</script> and is by definition a matrix such that when <script type="math/tex">\mathbf{A}^{-1}</script> and <script type="math/tex">\mathbf{A}</script> are multiplied together, the identity matrix <script type="math/tex">\mathbf{I}</script> results.  e.g. <script type="math/tex">\mathbf{A}^{-1} \mathbf{A} = \mathbf{I}</script>
</p>
<p>Lets consider the matrixes below
<script type="math/tex; mode=display">\begin{gather}
\mathbf{A}=
\begin{pmatrix}
2 & 3 \\
4 & -3 \\
\end{pmatrix}
\end{gather}</script>
</p>
<p>
<script type="math/tex; mode=display">\begin{gather}
\mathbf{A}^{-1}=
\begin{pmatrix}
\frac{1}{6} & \frac{1}{6} \\
~\\
\frac{2}{9} & -\frac{1}{9} \\
\end{pmatrix}
\end{gather}</script>
</p>
<p>We can check that the matrices are indeed inverses of each other using our Python code.</p>
<pre><code class="python"># multiplymatrix.py  -- Code to read and manipulate matrix
amatrix = [] # null list to store matrix reads
rowNumA = 0
colNumA = 0
######################################
# connect and read file for MATRIX A #
######################################
amatrix = [] # null list for reading file
afile = open(&quot;Amat.txt&quot;,&quot;r&quot;)
for line in afile:
    amatrix.append([float(n) for n in line.strip().split()])
    rowNumA += 1
afile.close() # Disconnect the file
######################################
# end file read ,disconnect file     #
######################################
colNumA = len(amatrix[0])
# print all columns each row
for i in range(0,rowNumA,1):
    print (amatrix[i][0:colNumA])
print (&quot;-----------------------------&quot;)
bmatrix = [] # null list to store matrix reads
rowNumB = 0
colNumB = 0
######################################
# connect and read file for MATRIX B #
######################################
bmatrix = [] # null list for reading file
afile = open(&quot;Bmat.txt&quot;,&quot;r&quot;)
for line in afile:
    bmatrix.append([float(n) for n in line.strip().split()])
    rowNumB += 1
afile.close() # Disconnect the file
######################################
# end file read ,disconnect file     #
######################################
colNumB = len(bmatrix[0])
# print all columns each row
for i in range(0,rowNumB,1):
    print (bmatrix[i][0:colNumB])
print (&quot;------------------------------&quot;)
##########################################################
### multiply the matrices, store result in result_matrix #
##########################################################
result_matrix = [[0 for j in range(colNumB)] for i in range(rowNumA)]
for i in range(0,rowNumA):
    for j in range(0,colNumB):
        for k in range(0,colNumA):
            result_matrix[i][j]=result_matrix[i][j]+amatrix[i][k]*bmatrix[k][j]
# observe the triple for-loop structure and the counting scheme
# print all cooumns each row
for i in range(0,rowNumA,1):
    print (result_matrix[i][0:colNumB])
</code></pre>

<pre><code>[2.0, 3.0]
[4.0, -3.0]
-----------------------------
[0.1666667, 0.1666667]
[0.2222222, -0.1111111]
------------------------------
[1.0, 1.0000000000287557e-07]
[2.0000000000575113e-07, 1.0000001]
</code></pre>
<p>The script above is our multiplication script modified to read the <script type="math/tex">\mathbf{A}</script> and <script type="math/tex">\mathbf{A}^{-1}</script>  perform the multiplication and then report the result. </p>
<p>Now that we have some background on what an inverse is, it would be nice to know how to find them --- that is a remarkably challenging problem.   Here we examine a classical algorithm for finding an inverse if we really need to --- computationally we only invert if necessary, there are other ways to "divide" that are faster.</p>
<h3 id="gauss-jordan-method-of-finding-mathbfa-1">Gauss-Jordan method of finding <script type="math/tex">\mathbf{A}^{-1}</script>
</h3>
<p>There are a number of methods that can be used to find the inverse of a matrix using elementary row operations.<br />
An elementary row operation is any one of the three operations listed below:</p>
<pre><code>    1. Multiply or divide an entire row by a constant
    2. Add or subtract a multiple of one row to/from another
    3. Exchange the position of any 2 rows
</code></pre>
<p>The Gauss-Jordan method of inverting a matrix can be divided into 4 main steps. </p>
<p>In order to find the inverse we will be working with the original matrix, augmented with the identity matrix -- this new matrix is called the augmented matrix (because no-one has tried to think of a cooler name yet).  </p>
<p>
<script type="math/tex; mode=display">\begin{gather}
\mathbf{A} | \mathbf{I} =
\begin{pmatrix}
2 & 3 & | & 1 & 0 \\
4 & -3 & | & 0 & 1 \\
\end{pmatrix}
\end{gather}</script>
</p>
<p>We will perform elementary row operations based on the left matrix to convert it to an identity matrix -- we perform the same operations on the right matrix and the result when we are done is the inverse of the original matrix.</p>
<p>So here goes -- in the theory here, we also get to do infinite-precision arithmetic, no rounding/truncation errors.  </p>
<p>1) Divide row one by the <script type="math/tex">a_{1,1}</script> value to force a <script type="math/tex">1</script> in the <script type="math/tex">a_{1,1}</script> position.   This is elementary row operation 1 in our list above.
<script type="math/tex; mode=display">\begin{gather}
\mathbf{A} | \mathbf{I} =
\begin{pmatrix}
2/2 & 3/2 & | & 1/2 & 0 \\
4 & -3 & | & 0 & 1 \\
\end{pmatrix}
=
\begin{pmatrix}
1 & 3/2 & | & 1/2 & 0 \\
4 & -3 & | & 0 & 1 \\
\end{pmatrix}
\end{gather}</script>
</p>
<p>2) For all rows below the first row, replace <script type="math/tex">row_j</script> with <script type="math/tex">row_j - a_{j,1}*row_1</script>.<br />
This happens to be elementary row operation 2 in our list above.
<script type="math/tex; mode=display">\begin{gather}
\mathbf{A} | \mathbf{I} =
\begin{pmatrix}
1 & 3/2 & | & 1/2 & 0 \\
4 - 4(1) & -3 - 4(3/2) & | & 0-4(1/2) & 1-4(0) \\
\end{pmatrix}
=
\begin{pmatrix}
1 & 3/2 & | & 1/2 & 0 \\
0 & -9 & | & -2 & 1 \\
\end{pmatrix}
\end{gather}</script>
</p>
<p>3) Now multiply <script type="math/tex">row_2</script> by <script type="math/tex"> \frac{1}{ a_{2,2}} </script>.  This is again elementary row operation 1 in our list above.</p>
<p>
<script type="math/tex; mode=display">\begin{gather}
\mathbf{A} | \mathbf{I} =
\begin{pmatrix}
1 & 3/2 & | & 1/2 & 0 \\
0 & -9/-9 & | & -2/-9 & 1/-9 \\
\end{pmatrix}
=
\begin{pmatrix}
1 & 3/2 & | & 1/2 & 0 \\
0 & 1 & | & 2/9 & -1/9 \\
\end{pmatrix}
\end{gather}</script>
</p>
<p>4) For all rows above and below this current row, replace <script type="math/tex">row_j</script> with <script type="math/tex">row_j - a_{2,2}*row_2</script>.<br />
This happens to again be elementary row operation 2 in our list above.<br />
What we are doing is systematically converting the left matrix into an identity matrix by multiplication of constants and addition to eliminate off-diagonal values and force 1 on the diagonal.</p>
<p>
<script type="math/tex; mode=display">\begin{gather}
\mathbf{A} | \mathbf{I} = \\
\begin{pmatrix}
1 & 3/2 - (3/2)(1) & | & 1/2 - (3/2)(2/9) & 0-(3/2)(-1/9) \\
0 & 1 & | & 2/9 & -1/9 \\
\end{pmatrix}
= \\
\begin{pmatrix}
1 & 0 & | & 1/6 & 1/6 \\
0 & 1 & | & 2/9 & -1/9 \\
\end{pmatrix}
\end{gather}</script>
</p>
<p>5) As far as this example is concerned we are done and have found the inverse.<br />
With more than a 2X2 system there will be many operations moving up and down the matrix to eliminate the off-diagonal terms.</p>
<pre><code class="python">
</code></pre>

<pre><code class="python">
</code></pre>

<pre><code class="python">
</code></pre>

<pre><code class="python"># InvertASystem.py
# Code to read A and b
# Then solve Ax = b for x by Gaussian elimination with back substitution
#
print (&quot;invert a matrix&quot;)
print (&quot;wrapper loop -- OK&quot;)
print (&quot;run wrapper through two iterations, same inputs&quot;)
print (&quot;added xmatrix,bmatrix -- get same result &quot;)
print (&quot;suppress vector only calcs&quot;)
print (&quot;clean up output&quot;)
amatrix = [] # null list to store matrix reads
bvector = []
rowNumA = 0
colNumA = 0
rowNumB = 0
######################################
# connect and read file for MATRIX A #
######################################
afile = open(&quot;A.txt&quot;,&quot;r&quot;)
for line in afile:
    amatrix.append([float(n) for n in line.strip().split()])
    rowNumA += 1
afile.close() # Disconnect the file
######################################
# end file read ,disconnect file     #
######################################
colNumA = len(amatrix[0])
afile = open(&quot;B.txt&quot;,&quot;r&quot;)
for line in afile:
    bvector.append(float(line))  # vector read different -- just float the line
    rowNumB += 1
afile.close() # Disconnect the file
print (bvector)
# check the arrays
if rowNumA != rowNumB:
    print (&quot;row ranks not same -- aborting now&quot;)
    quit()
else:
    print (&quot;row ranks same -- continuing operation&quot;)
# print all columns each row
cmatrix = [[0 for j in range(colNumA)]for i in range(rowNumA)]
dmatrix = [[0 for j in range(colNumA)]for i in range(rowNumA)]
bmatrix = [[0 for j in range(colNumA)]for i in range(rowNumA)]
xmatrix = [[0 for j in range(colNumA)]for i in range(rowNumA)]
xvector = [0 for i in range(rowNumA)]
for i in range(0,rowNumA,1):
    print (amatrix[i][0:colNumA], cmatrix[i][0:colNumA])
    bmatrix[i][i] = 1.0
print (&quot;-----------------------------&quot;)
# copy amatrix into dmatrix  -- this is a static copy
dmatrix = [[amatrix[i][j] for j in range(colNumA)]for i in range(rowNumA)]
# now attempt invert

#
# outer wrapper loop
#
for jcol in range(rowNumA):
#    print &quot;run &quot;,jcol
    xvector = [0 for i in range(rowNumA)]
#    xmatrix = [[0 for j in range(colNumA)]for i in range(rowNumA)]
    for i in range(rowNumA):
        bvector[i]=bmatrix[i][jcol]
    amatrix = [[dmatrix[i][j] for j in range(colNumA)]for i in range(rowNumA)]
    cmatrix = [[dmatrix[i][j] for j in range(colNumA)]for i in range(rowNumA)]
    print (&quot;reset A matrix, x vector, b vector&quot;)
    for i in range(0,rowNumA,1):
        print (amatrix[i][0:colNumA],xvector[i],bvector[i]) 
    print (&quot;-----------------------------&quot;)
# build the diagonal -- assume diagonally dominant
    for k in range(rowNumA-1):
        l = k+1
        for i in range(l,rowNumA):
            for j in range(colNumA):
                cmatrix[i][j]=amatrix[i][j]-amatrix[k][j]*amatrix[i][k]/amatrix[k][k]
            bvector[i] = bvector[i]-bvector[k]*amatrix[i][k]/amatrix[k][k]
            bmatrix[i][jcol] = bmatrix[i][jcol]-bmatrix[k][jcol]*amatrix[i][k]/amatrix[k][k]
        for i in range(rowNumA):
            for j in range(colNumA):
                amatrix[i][j] = cmatrix[i][j]
# gaussian reduction done
# now for the back substitution
    for i in range(0,rowNumA,1):
        print (amatrix[i][0:colNumA], bvector[i],cmatrix[i][0:colNumA])
    print (&quot;-----------------------------&quot;)
    for k in range(rowNumA-1,-1,-1):
        sum = 0.0
        sum1 = 0.0
        for i in range(rowNumA):
            if i == k:
                continue 
            else:
                sum = sum + amatrix[k][i]*xvector[i]
                sum1 = sum1 + amatrix[k][i]*xmatrix[i][jcol]
            xvector[k]=(bvector[k]-sum)/amatrix[k][k]
            xmatrix[k][jcol]=(bmatrix[k][jcol]-sum1)/amatrix[k][k]
    for i in range(0,rowNumA,1):
        print (dmatrix[i][0:colNumA],xvector[i],bvector[i]) 
    print (&quot;-----------------------------&quot;)
    for i in range(0,rowNumA,1):
        print (dmatrix[i][0:colNumA],xmatrix[i][jcol],bmatrix[i][jcol]) 
    print (&quot;-----------------------------&quot;)
# end of wrapper
print (&quot;[      A-Matrix          ]|[       A-Inverse        ]&quot;)
print (&quot;_____________________________________________________&quot;)
for i in range(0,rowNumA,1):
    print (dmatrix[i][0:colNumA],&quot;|&quot;, xmatrix[i][0:colNumA])
print (&quot;_____________________________________________________&quot;)
ofile = open(&quot;A-Matrix.txt&quot;,&quot;w&quot;) # &quot;w&quot; clobbers content already there!
for i in range(0,rowNumA,1):
    message = '  '.join(map(repr, dmatrix[i][0:colNumA])) + &quot;\n&quot; 
    ofile.write(message)
ofile.close()
ofile = open(&quot;A-Inverse.txt&quot;,&quot;w&quot;) # &quot;w&quot; clobbers content already there!
for i in range(0,rowNumA,1):
    message = '  '.join(map(repr, xmatrix[i][0:colNumA])) + &quot;\n&quot;
    ofile.write(message)
ofile.close()


</code></pre>

<pre><code>invert a matrix
wrapper loop -- OK
run wrapper through two iterations, same inputs
added xmatrix,bmatrix -- get same result 
suppress vector only calcs
clean up output
[5.0, 6.0, 7.0, 8.0, 9.0]
row ranks same -- continuing operation
[4.0, 1.5, 0.7, 1.2, 0.5] [0, 0, 0, 0, 0]
[1.0, 6.0, 0.9, 1.4, 0.7] [0, 0, 0, 0, 0]
[0.5, 1.0, 3.9, 3.2, 0.9] [0, 0, 0, 0, 0]
[0.2, 2.0, 0.2, 7.5, 1.9] [0, 0, 0, 0, 0]
[1.7, 0.9, 1.2, 2.3, 4.9] [0, 0, 0, 0, 0]
-----------------------------
reset A matrix, x vector, b vector
[4.0, 1.5, 0.7, 1.2, 0.5] 0 1.0
[1.0, 6.0, 0.9, 1.4, 0.7] 0 0
[0.5, 1.0, 3.9, 3.2, 0.9] 0 0
[0.2, 2.0, 0.2, 7.5, 1.9] 0 0
[1.7, 0.9, 1.2, 2.3, 4.9] 0 0
-----------------------------
[4.0, 1.5, 0.7, 1.2, 0.5] 1.0 [4.0, 1.5, 0.7, 1.2, 0.5]
[0.0, 5.625, 0.7250000000000001, 1.0999999999999999, 0.575] -0.25 [0.0, 5.625, 0.7250000000000001, 1.0999999999999999, 0.575]
[0.0, 0.0, 3.707777777777778, 2.8911111111111114, 0.7544444444444445] -0.08888888888888889 [0.0, 0.0, 3.707777777777778, 2.8911111111111114, 0.7544444444444445]
[0.0, 0.0, 0.0, 7.128360803116572, 1.6951333533113575] 0.03356308061132753 [0.0, 0.0, 0.0, 7.128360803116572, 1.6951333533113575]
[0.0, 0.0, 0.0, 0.0, 4.231527930403315] -0.3975053957273071 [0.0, 0.0, 0.0, 0.0, 4.231527930403315]
-----------------------------
[4.0, 1.5, 0.7, 1.2, 0.5] 0.27196423630168165 1.0
[1.0, 6.0, 0.9, 1.4, 0.7] -0.036786468827077756 -0.25
[0.5, 1.0, 3.9, 3.2, 0.9] -0.025949127789423248 -0.08888888888888889
[0.2, 2.0, 0.2, 7.5, 1.9] 0.027047195749338872 0.03356308061132753
[1.7, 0.9, 1.2, 2.3, 4.9] -0.0939389748254409 -0.3975053957273071
-----------------------------
[4.0, 1.5, 0.7, 1.2, 0.5] 0.27196423630168165 1.0
[1.0, 6.0, 0.9, 1.4, 0.7] -0.036786468827077756 -0.25
[0.5, 1.0, 3.9, 3.2, 0.9] -0.025949127789423248 -0.08888888888888889
[0.2, 2.0, 0.2, 7.5, 1.9] 0.027047195749338872 0.03356308061132753
[1.7, 0.9, 1.2, 2.3, 4.9] -0.0939389748254409 -0.3975053957273071
-----------------------------
reset A matrix, x vector, b vector
[4.0, 1.5, 0.7, 1.2, 0.5] 0 0
[1.0, 6.0, 0.9, 1.4, 0.7] 0 1.0
[0.5, 1.0, 3.9, 3.2, 0.9] 0 0
[0.2, 2.0, 0.2, 7.5, 1.9] 0 0
[1.7, 0.9, 1.2, 2.3, 4.9] 0 0
-----------------------------
[4.0, 1.5, 0.7, 1.2, 0.5] 0 [4.0, 1.5, 0.7, 1.2, 0.5]
[0.0, 5.625, 0.7250000000000001, 1.0999999999999999, 0.575] 1.0 [0.0, 5.625, 0.7250000000000001, 1.0999999999999999, 0.575]
[0.0, 0.0, 3.707777777777778, 2.8911111111111114, 0.7544444444444445] -0.14444444444444443 [0.0, 0.0, 3.707777777777778, 2.8911111111111114, 0.7544444444444445]
[0.0, 0.0, 0.0, 7.128360803116572, 1.6951333533113575] -0.3454599940065927 [0.0, 0.0, 0.0, 7.128360803116572, 1.6951333533113575]
[0.0, 0.0, 0.0, 0.0, 4.231527930403315] 0.03860910887892463 [0.0, 0.0, 0.0, 0.0, 4.231527930403315]
-----------------------------
[4.0, 1.5, 0.7, 1.2, 0.5] -0.05581183146290884 0
[1.0, 6.0, 0.9, 1.4, 0.7] 0.18691841183385363 1.0
[0.5, 1.0, 3.9, 3.2, 0.9] -0.0013334022990376664 -0.14444444444444443
[0.2, 2.0, 0.2, 7.5, 1.9] -0.05063248905238324 -0.3454599940065927
[1.7, 0.9, 1.2, 2.3, 4.9] 0.009124153146082323 0.03860910887892463
-----------------------------
[4.0, 1.5, 0.7, 1.2, 0.5] -0.05581183146290884 0
[1.0, 6.0, 0.9, 1.4, 0.7] 0.18691841183385363 1.0
[0.5, 1.0, 3.9, 3.2, 0.9] -0.0013334022990376664 -0.14444444444444443
[0.2, 2.0, 0.2, 7.5, 1.9] -0.05063248905238324 -0.3454599940065927
[1.7, 0.9, 1.2, 2.3, 4.9] 0.009124153146082323 0.03860910887892463
-----------------------------
reset A matrix, x vector, b vector
[4.0, 1.5, 0.7, 1.2, 0.5] 0 0
[1.0, 6.0, 0.9, 1.4, 0.7] 0 0
[0.5, 1.0, 3.9, 3.2, 0.9] 0 1.0
[0.2, 2.0, 0.2, 7.5, 1.9] 0 0
[1.7, 0.9, 1.2, 2.3, 4.9] 0 0
-----------------------------
[4.0, 1.5, 0.7, 1.2, 0.5] 0 [4.0, 1.5, 0.7, 1.2, 0.5]
[0.0, 5.625, 0.7250000000000001, 1.0999999999999999, 0.575] 0.0 [0.0, 5.625, 0.7250000000000001, 1.0999999999999999, 0.575]
[0.0, 0.0, 3.707777777777778, 2.8911111111111114, 0.7544444444444445] 1.0 [0.0, 0.0, 3.707777777777778, 2.8911111111111114, 0.7544444444444445]
[0.0, 0.0, 0.0, 7.128360803116572, 1.6951333533113575] 0.022415343122565184 [0.0, 0.0, 0.0, 7.128360803116572, 1.6951333533113575]
[0.0, 0.0, 0.0, 0.0, 4.231527930403315] -0.23761967500359435 [0.0, 0.0, 0.0, 0.0, 4.231527930403315]
-----------------------------
[4.0, 1.5, 0.7, 1.2, 0.5] -0.032853102922602934 0
[1.0, 6.0, 0.9, 1.4, 0.7] -0.032062455842026744 0.0
[0.5, 1.0, 3.9, 3.2, 0.9] 0.26826513178341493 1.0
[0.2, 2.0, 0.2, 7.5, 1.9] 0.01649816113355711 0.022415343122565184
[1.7, 0.9, 1.2, 2.3, 4.9] -0.05615458031041434 -0.23761967500359435
-----------------------------
[4.0, 1.5, 0.7, 1.2, 0.5] -0.032853102922602934 0
[1.0, 6.0, 0.9, 1.4, 0.7] -0.032062455842026744 0.0
[0.5, 1.0, 3.9, 3.2, 0.9] 0.26826513178341493 1.0
[0.2, 2.0, 0.2, 7.5, 1.9] 0.01649816113355711 0.022415343122565184
[1.7, 0.9, 1.2, 2.3, 4.9] -0.05615458031041434 -0.23761967500359435
-----------------------------
reset A matrix, x vector, b vector
[4.0, 1.5, 0.7, 1.2, 0.5] 0 0
[1.0, 6.0, 0.9, 1.4, 0.7] 0 0
[0.5, 1.0, 3.9, 3.2, 0.9] 0 0
[0.2, 2.0, 0.2, 7.5, 1.9] 0 1.0
[1.7, 0.9, 1.2, 2.3, 4.9] 0 0
-----------------------------
[4.0, 1.5, 0.7, 1.2, 0.5] 0 [4.0, 1.5, 0.7, 1.2, 0.5]
[0.0, 5.625, 0.7250000000000001, 1.0999999999999999, 0.575] 0.0 [0.0, 5.625, 0.7250000000000001, 1.0999999999999999, 0.575]
[0.0, 0.0, 3.707777777777778, 2.8911111111111114, 0.7544444444444445] 0.0 [0.0, 0.0, 3.707777777777778, 2.8911111111111114, 0.7544444444444445]
[0.0, 0.0, 0.0, 7.128360803116572, 1.6951333533113575] 1.0 [0.0, 0.0, 0.0, 7.128360803116572, 1.6951333533113575]
[0.0, 0.0, 0.0, 0.0, 4.231527930403315] -0.1488884423394965 [0.0, 0.0, 0.0, 0.0, 4.231527930403315]
-----------------------------
[4.0, 1.5, 0.7, 1.2, 0.5] -0.016869919448735553 0
[1.0, 6.0, 0.9, 1.4, 0.7] -0.011456196435011407 0.0
[0.5, 1.0, 3.9, 3.2, 0.9] -0.10875073215127727 0.0
[0.2, 2.0, 0.2, 7.5, 1.9] 0.1486518640705042 1.0
[1.7, 0.9, 1.2, 2.3, 4.9] -0.03518550386250331 -0.1488884423394965
-----------------------------
[4.0, 1.5, 0.7, 1.2, 0.5] -0.016869919448735553 0
[1.0, 6.0, 0.9, 1.4, 0.7] -0.011456196435011407 0.0
[0.5, 1.0, 3.9, 3.2, 0.9] -0.10875073215127727 0.0
[0.2, 2.0, 0.2, 7.5, 1.9] 0.1486518640705042 1.0
[1.7, 0.9, 1.2, 2.3, 4.9] -0.03518550386250331 -0.1488884423394965
-----------------------------
reset A matrix, x vector, b vector
[4.0, 1.5, 0.7, 1.2, 0.5] 0 0
[1.0, 6.0, 0.9, 1.4, 0.7] 0 0
[0.5, 1.0, 3.9, 3.2, 0.9] 0 0
[0.2, 2.0, 0.2, 7.5, 1.9] 0 0
[1.7, 0.9, 1.2, 2.3, 4.9] 0 1.0
-----------------------------
[4.0, 1.5, 0.7, 1.2, 0.5] 0 [4.0, 1.5, 0.7, 1.2, 0.5]
[0.0, 5.625, 0.7250000000000001, 1.0999999999999999, 0.575] 0.0 [0.0, 5.625, 0.7250000000000001, 1.0999999999999999, 0.575]
[0.0, 0.0, 3.707777777777778, 2.8911111111111114, 0.7544444444444445] 0.0 [0.0, 0.0, 3.707777777777778, 2.8911111111111114, 0.7544444444444445]
[0.0, 0.0, 0.0, 7.128360803116572, 1.6951333533113575] 0.0 [0.0, 0.0, 0.0, 7.128360803116572, 1.6951333533113575]
[0.0, 0.0, 0.0, 0.0, 4.231527930403315] 1.0 [0.0, 0.0, 0.0, 0.0, 4.231527930403315]
-----------------------------
[4.0, 1.5, 0.7, 1.2, 0.5] -0.0072026931722172435 0
[1.0, 6.0, 0.9, 1.4, 0.7] -0.012617687833839365 0.0
[0.5, 1.0, 3.9, 3.2, 0.9] -0.004266180002777282 0.0
[0.2, 2.0, 0.2, 7.5, 1.9] -0.05619749842697155 0.0
[1.7, 0.9, 1.2, 2.3, 4.9] 0.23632125710787594 1.0
-----------------------------
[4.0, 1.5, 0.7, 1.2, 0.5] -0.0072026931722172435 0
[1.0, 6.0, 0.9, 1.4, 0.7] -0.012617687833839365 0.0
[0.5, 1.0, 3.9, 3.2, 0.9] -0.004266180002777282 0.0
[0.2, 2.0, 0.2, 7.5, 1.9] -0.05619749842697155 0.0
[1.7, 0.9, 1.2, 2.3, 4.9] 0.23632125710787594 1.0
-----------------------------
[      A-Matrix          ]|[       A-Inverse        ]
_____________________________________________________
[4.0, 1.5, 0.7, 1.2, 0.5] | [0.27196423630168165, -0.05581183146290884, -0.032853102922602934, -0.016869919448735553, -0.0072026931722172435]
[1.0, 6.0, 0.9, 1.4, 0.7] | [-0.036786468827077756, 0.18691841183385363, -0.032062455842026744, -0.011456196435011407, -0.012617687833839365]
[0.5, 1.0, 3.9, 3.2, 0.9] | [-0.025949127789423248, -0.0013334022990376664, 0.26826513178341493, -0.10875073215127727, -0.004266180002777282]
[0.2, 2.0, 0.2, 7.5, 1.9] | [0.027047195749338872, -0.05063248905238324, 0.01649816113355711, 0.1486518640705042, -0.05619749842697155]
[1.7, 0.9, 1.2, 2.3, 4.9] | [-0.0939389748254409, 0.009124153146082323, -0.05615458031041434, -0.03518550386250331, 0.23632125710787594]
_____________________________________________________
</code></pre>
<pre><code class="python">print (amatrix)
</code></pre>

<pre><code>[[4.0, 1.5, 0.7, 1.2, 0.5], [0.0, 5.625, 0.7250000000000001, 1.0999999999999999, 0.575], [0.0, 0.0, 3.707777777777778, 2.8911111111111114, 0.7544444444444445], [0.0, 0.0, 0.0, 7.128360803116572, 1.6951333533113575], [0.0, 0.0, 0.0, 0.0, 4.231527930403315]]
</code></pre>
<pre><code class="python">
</code></pre>

<h2 id="supply-code-with-pivoting">Supply Code with Pivoting</h2>
<h2 id="supply-numpy-code">Supply numpy code</h2>
<h2 id="do-a-couple-examples">Do a couple examples</h2>
<pre><code class="python">
</code></pre>

<h2 id="practical-application-of-linear-solvers">Practical Application of Linear Solvers</h2>
<p>A typical static truss analysis problem goes like </p>
<pre><code>"The figure below is a simply supported, statically determinate truss with pin connections (zero moment transfer connections).   Find the forces in each member for the loading shown."
</code></pre>
<p><img alt="" src="../StaticTrussSketch.jpg" /></p>
<p>This notebook will illustrate how to leverage our linear systems solver(s) to analyze the truss.  The approach uses concepts from statics and computational thinking.</p>
<p>From statics</p>
<pre><code>1) method of joints (for reactions and internal forcez)
2) direction cosines
</code></pre>
<p>From computational thinking</p>
<pre><code>1) read input file
2) construct linear system \textbf{Ax=b}; solve for \textbf{x}
3) report results
</code></pre>
<p>Before even contemplating writing/using a program we need to build a mathematical model of the truss and assemble the system of linear equations that result from the model.  </p>
<p>So the first step is to sketch a free-body-diagram as below and build a node naming convention and force names.</p>
<p><img alt="" src="../StaticTrussFBD.jpg" /></p>
<p>Next we will write the force balance for each of the six nodes (<script type="math/tex">N1</script>-<script type="math/tex">N6</script>), which will produce a total of 12 equations in the 12 unknowns (the 9 member forces, and 3 reactions).</p>
<p>The figure below is the force balance for node <script type="math/tex">N1</script>, the two force equations (for the horizontal, <script type="math/tex">x</script>, direction and the vertical, <script type="math/tex">y</script>, direction) are listed below the figure.</p>
<p><img alt="" src="../Node1.jpg" /></p>
<p>
<script type="math/tex; mode=display">\begin{gather}
\begin{matrix}
\sum F_x = 0 = & +F_1cos(45) & + F_2 &  &  &  &  &  &  & + A_x &  &  & & & \\
\sum F_y = 0 = & +F_1sin(45) &  & &  &  &  &  &  &  &  & + A_y &  &  & \\
\end{matrix}
\end{gather}</script>
</p>
<p>The equation above is the force balance equation pair for the node.  The <script type="math/tex">x</script> component equation will later be named <script type="math/tex">N1_x</script> to indicate it arises from Node 1, <script type="math/tex">x</script> component equation.   A similar notation convention will also be adopted for the <script type="math/tex">y</script> component equation.  There will be an equation pair for each node.</p>
<p>Below is a sketch of the force balance for node <script type="math/tex">N2</script>, the two force equations (for the horizontal, <script type="math/tex">x</script>, direction and the vertical, <script type="math/tex">y</script>, direction) are listed below the figure.</p>
<p><img alt="" src="../Node2.jpg" /></p>
<p>
<script type="math/tex; mode=display">\begin{gather}
\begin{matrix}
\sum F_x = 0 = &  & -F_2 &  &  &  & +F_6 &  &  &  &  &  &  & & \\
\sum F_y = 0 =  &  &  & +F_3 &  &  &  &  &  &  &  &  &  & & \\
\end{matrix}
\end{gather}</script>
</p>
<p>Below is a sketch of the force balance for node <script type="math/tex">N3</script>, the two force equations (for the horizontal, <script type="math/tex">x</script>, direction and the vertical, <script type="math/tex">y</script>, direction) are listed below the figure.</p>
<p><img alt="" src="../Node3.jpg" /></p>
<p>
<script type="math/tex; mode=display">\begin{gather}
\begin{matrix}
\sum F_x = 0 = &  &  &  &  & -F_5cos(30) & -F_6 & & +F_8 &  &  &  &  &  & \\
\sum F_y = 0 =  &  &  &  &  & F_5sin(30) &  & +F_7 &  &  &  &  &  &  & -P_3\\
\end{matrix}
\end{gather}</script>
</p>
<p>Above is the force balance equation pair for node <script type="math/tex">N3</script>.</p>
<p>Below is a sketch of the force balance for node <script type="math/tex">N4</script>, the two force equations (for the horizontal, <script type="math/tex">x</script>, direction and the vertical, <script type="math/tex">y</script>, direction) are listed below the figure.</p>
<p><img alt="" src="../Node4.jpg" /></p>
<p>
<script type="math/tex; mode=display">\begin{gather}
\begin{matrix}
\sum F_x = 0 = &  &  &  &  &  &  &  & -F_8 & -F_9cos(45) &  &  &  &  & \\
\sum F_y = 0 =  &  &  &  &  &  &  &  &  & F_9sin(45) &  &  & +B_y  &  & \\
\end{matrix}
\end{gather}</script>
</p>
<p>Above is the force balance equation pair for node <script type="math/tex">N4</script>.</p>
<p>Below is a sketch of the force balance for node <script type="math/tex">N5</script>, the two force equations (for the horizontal, <script type="math/tex">x</script>, direction and the vertical, <script type="math/tex">y</script>, direction) are listed below the figure.</p>
<p><img alt="" src="../Node5.jpg" /></p>
<p>
<script type="math/tex; mode=display">\begin{gather}
\begin{matrix}
\sum F_x = 0 = & -F_1cos(45) &  &   & +F_4 & +F_5cos(30) &  &  &  &  &  &  &  &  & \\
\sum F_y = 0 =  & -F_1sin(45) &  & -F_3 &   & -F_5sin(30) &  &  &  &  &  &  &  &  & -P_1\\
\end{matrix}
\end{gather}</script>
</p>
<p>Above is the force balance equation pair for node <script type="math/tex">N5</script>.</p>
<p>Below is a sketch of the force balance for node <script type="math/tex">N6</script>, the two force equations (for the horizontal, <script type="math/tex">x</script>, direction and the vertical, <script type="math/tex">y</script>, direction) are listed below the figure.</p>
<p><img alt="" src="../Node6.jpg" /></p>
<p>
<script type="math/tex; mode=display">\begin{gather}
\begin{matrix}
\sum F_x = 0 = &  &  &  & -F_4 &  &  &  &  & F_9sin(45) &  &  &  &  & \\
\sum F_y = 0 =  &  &  &  &  &  &  & -F_7 &  & -F_9cos(45) &  &  &  &  & P_2\\
\end{matrix}
\end{gather}</script>
</p>
<p>Above is the force balance equation pair for node <script type="math/tex">N6</script>.</p>
<p>The next step is to gather the equation pairs into a system of linear equations. <br />
We will move the known loads to the right hand side and essentially construct the matrix equation <script type="math/tex">\mathbf{A}\mathbf{x} = \mathbf{b}</script>.   </p>
<p>The system below is a matrix representation of the equation pairs with the forces moved to the right hand side <script type="math/tex">\mathbf{b} = RHS</script>. </p>
<p>
<script type="math/tex; mode=display">\begin{gather}
\begin{pmatrix}
~ & F_1 & F_2 & F_3 & F_4 & F_5 & F_6 & F_7 & F_8 & F_9 & A_x & A_y & B_y & | & RHS\\
\hline
N1_x & 0.707 & 1 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 1 & 0 & 0 & | & 0\\
N1_y & 0.707 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 1 & 0 & | & 0\\
N2_x & 0 & -1 & 0 & 0 & 0 & 1 & 0 & 0 & 0 & 0 & 0 & 0 & | & 0\\
N2_y & 0 & 0 & 1 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & | & 0\\
N3_x & 0 & 0 & 0 & 0 & -0.866 & -1 & 0 & 1 & 0 & 0 & 0 & 0 & | & 0\\
N3_y & 0 & 0 & 0 & 0 & 0.5 & 0 & 1 & 0 & 0 & 0 & 0 & 0 & | & P_3\\
N4_x & 0 & 0 & 0 & 0 & 0 & 0 & 0 & -1 & -0.707 & 0 & 0 & 0 & | & 0\\
N4_y & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0.707 & 0 & 0 & 0 & | & 0\\
N5_x & -0.707 & 0 & 0 & 1 & 0.866 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & | & 0\\
N5_y & -0.707 & 0 & -1 & 0 & -0.5 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & | & P_1\\
N6_x & 0 & 0 & 0 & -1 & 0 & 0 & 0 & 0 & 0.707 & 0 & 0 & 0 & | & 0\\
N6_y & 0 & 0 & 0 & 0 & 0 & 0 & -1 & 0 & -0.707 & 0 & 0 &  0 & | & -P_2\\
\end{pmatrix}
\end{gather}</script>
</p>
<p>In the system, the rows are labeled on the left-most column with their node-related equation name. <br />
Thus each row of the matrix corresponds to an equation derived from a node. <br />
The columns are labeled with their respective unknown force (except the last column, which represents the right-hand-side of the system of linear equations).<br />
Thus the coefficient in each column corresponds to a force in each node equation. <br />
The sign of the coefficient refers to the assumed direction the force acts.   </p>
<p>In the analysis all the members were assumed to be in tension (except for the reaction forces). <br />
If a coefficient has a value of zero in a particular row, then that force does no act at the node to which the row corresponds.    </p>
<p>From this representation the transition to the formal vector-matrix representation is straightforward. </p>
<p>
<script type="math/tex; mode=display">\begin{gather}
\mathbf{A} =
\begin{pmatrix}
0.707 & 1 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 1 & 0 & 0 \\
0.707 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 1 & 0 \\
0 & -1 & 0 & 0 & 0 & 1 & 0 & 0 & 0 & 0 & 0 & 0 \\
0 & 0 & 1 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 \\
0 & 0 & 0 & 0 & -0.866 & -1 & 0 & 1 & 0 & 0 & 0 & 0 \\
0 & 0 & 0 & 0 & 0.5 & 0 & 1 & 0 & 0 & 0 & 0 & 0 \\
0 & 0 & 0 & 0 & 0 & 0 & 0 & -1 & -0.707 & 0 & 0 & 0 \\
0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0.707 & 0 & 0 & 0 \\
-0.707 & 0 & 0 & 1 & 0.866 & 0 & 0 & 0 & 0 & 0 & 0 & 0 \\
-0.707 & 0 & -1 & 0 & -0.5 & 0 & 0 & 0 & 0 & 0 & 0 & 0 \\
0 & 0 & 0 & -1 & 0 & 0 & 0 & 0 & 0.707 & 0 & 0 & 0 \\
0 & 0 & 0 & 0 & 0 & 0 & -1 & 0 & -0.707 & 0 & 0 &  0 \\
\end{pmatrix}
\end{gather}</script>
</p>
<p>
<script type="math/tex; mode=display">\begin{gather}
\mathbf{x} =
\begin{pmatrix}
F_1\\
F_2\\
F_3\\
F_4\\
F_5\\
F_6\\
F_7\\
F_8\\
F_9\\
A_x\\
A_y\\
B_y\\
\end{pmatrix}
\end{gather}</script>
</p>
<p>
<script type="math/tex; mode=display">\begin{gather}
\mathbf{b} =
\begin{pmatrix}
0\\
0\\
0\\
0\\
0\\
P_3\\
0\\
0\\
0\\
P_1\\
0\\
-P_2\\
\end{pmatrix}
\end{gather}</script>
</p>
<p>The various matrices above are entere into text files named A.txt and B.txt, we can examine the file contents using the host OS as below</p>
<pre><code class="python"># list contents of the A matrix, uses call to OS host
!(cat A.txt)
</code></pre>

<pre><code>4.0  1.5  0.7  1.2  0.5
1.0  6.0  0.9  1.4  0.7
0.5  1.0  3.9  3.2  0.9
0.2  2.0  0.2  7.5  1.9
1.7  0.9  1.2  2.3  4.9
</code></pre>
<pre><code class="python"># list contents of RHS or b vector
!(cat B.txt)
</code></pre>

<pre><code>5.0
6.0
7.0
8.0
9.0
</code></pre>
<p>Now we use our solver tools, here I have not doen much on tidy output, thats left for the reader.</p>
<pre><code class="python"># Linear System Solver

from LinearSolverPivot import linearsolver

amatrix = [] # null list to store matrix reads
bvector = []
rowNumA = 0
colNumA = 0
rowNumB = 0
afile = open(&quot;A.txt&quot;,&quot;r&quot;)  # connect and read file for MATRIX A 
for line in afile:
    amatrix.append([float(n) for n in line.strip().split()])
    rowNumA += 1
afile.close() # Disconnect the file
colNumA = len(amatrix[0])
afile = open(&quot;B.txt&quot;,&quot;r&quot;)  # connect and read file for MATRIX B 
for line in afile:
    bvector.append(float(line))  # vector read different -- just float the line
    rowNumB += 1
afile.close() # Disconnect the file
#print (bvector)
if rowNumA != rowNumB:   # check the arrays
    print (&quot;row ranks not same -- aborting now&quot;)
    quit()
else:
    print (&quot;row ranks same -- continuing operation&quot;)
# print all columns each row
cmatrix = [[0 for j in range(colNumA)]for i in range(rowNumA)]
dmatrix = [[0 for j in range(colNumA)]for i in range(rowNumA)]
xvector = [0 for i in range(rowNumA)]
dvector = [0 for i in range(rowNumA)]
for i in range(0,rowNumA,1):
    print (amatrix[i][0:colNumA], bvector[i])
print (&quot;-----------------------------&quot;)
# copy amatrix into cmatrix
cmatrix = [[amatrix[i][j] for j in range(colNumA)]for i in range(rowNumA)]
dmatrix = [[amatrix[i][j] for j in range(colNumA)]for i in range(rowNumA)]
dvector = [bvector[i] for i in range(rowNumA)]
dvector = linearsolver(amatrix,bvector)
for i in range(0,rowNumA,1):
    print (dvector[i])
print (&quot;-----------------------------&quot;)
</code></pre>

<pre><code>row ranks same -- continuing operation
[4.0, 1.5, 0.7, 1.2, 0.5] 5.0
[1.0, 6.0, 0.9, 1.4, 0.7] 6.0
[0.5, 1.0, 3.9, 3.2, 0.9] 7.0
[0.2, 2.0, 0.2, 7.5, 1.9] 8.0
[1.7, 0.9, 1.2, 2.3, 4.9] 9.0
-----------------------------
0.5951948781328953
0.5079321739889
0.831708392507349
0.6303655990885844
1.0373752656472461
-----------------------------
</code></pre>
<h2 id="references">References</h2>
<p>Overland, B. (2018). Python Without Fear. Addison-Wesley 
ISBN 978-0-13-468747-6. </p>
<p>Grus, Joel (2015). Data Science from Scratch: First Principles with Python OâReilly
Media. Kindle Edition.</p>
<p>Precord, C. (2010) wxPython 2.8 Application Development Cookbook Packt Publishing Ltd. Birmingham , B27 6PA, UK 
ISBN 978-1-849511-78-0.</p>
<pre><code class="python">import numpy as np

amatrix = [] # null list to store matrix reads
bvector = []
rowNumA = 0
colNumA = 0
rowNumB = 0
afile = open(&quot;A.txt&quot;,&quot;r&quot;)  # connect and read file for MATRIX A 
for line in afile:
    amatrix.append([float(n) for n in line.strip().split()])
    rowNumA += 1
afile.close() # Disconnect the file
afile = open(&quot;B.txt&quot;,&quot;r&quot;)  # connect and read file for MATRIX B 
for line in afile:
    bvector.append(float(line))  # vector read different -- just float the line
    rowNumB += 1
afile.close() # Disconnect the file

A = np.array(amatrix)
b = np.array(bvector)
x = np.linalg.solve(A, b)
print(x)
</code></pre>

<pre><code>[0.59519488 0.50793217 0.83170839 0.6303656  1.03737527]
</code></pre>
<pre><code class="python">
</code></pre></div>
        </div>

        <footer class="col-md-12">
            <hr>
            <p>Documentation built with <a href="https://www.mkdocs.org/">MkDocs</a>.</p>
        </footer>
        <script>
            var base_url = "../../..",
                shortcuts = {"help": 191, "next": 78, "previous": 80, "search": 83};
        </script>
        <script src="../../../js/base.js" defer></script>
        <script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS_HTML" defer></script>
        <script src="../../../mathjaxhelper.js" defer></script>
        <script src="../../../search/main.js" defer></script>

        <div class="modal" id="mkdocs_search_modal" tabindex="-1" role="dialog" aria-labelledby="Search Modal" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
                <h4 class="modal-title" id="exampleModalLabel">Search</h4>
            </div>
            <div class="modal-body">
                <p>
                    From here you can search these documents. Enter
                    your search terms below.
                </p>
                <form role="form">
                    <div class="form-group">
                        <input type="text" class="form-control" placeholder="Search..." id="mkdocs-search-query" title="Type search term here">
                    </div>
                </form>
                <div id="mkdocs-search-results"></div>
            </div>
            <div class="modal-footer">
            </div>
        </div>
    </div>
</div><div class="modal" id="mkdocs_keyboard_modal" tabindex="-1" role="dialog" aria-labelledby="Keyboard Shortcuts Modal" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
                <h4 class="modal-title" id="exampleModalLabel">Keyboard Shortcuts</h4>
            </div>
            <div class="modal-body">
              <table class="table">
                <thead>
                  <tr>
                    <th style="width: 20%;">Keys</th>
                    <th>Action</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td class="help shortcut"><kbd>?</kbd></td>
                    <td>Open this help</td>
                  </tr>
                  <tr>
                    <td class="next shortcut"><kbd>n</kbd></td>
                    <td>Next page</td>
                  </tr>
                  <tr>
                    <td class="prev shortcut"><kbd>p</kbd></td>
                    <td>Previous page</td>
                  </tr>
                  <tr>
                    <td class="search shortcut"><kbd>s</kbd></td>
                    <td>Search</td>
                  </tr>
                </tbody>
              </table>
            </div>
            <div class="modal-footer">
            </div>
        </div>
    </div>
</div>

    </body>
</html>
